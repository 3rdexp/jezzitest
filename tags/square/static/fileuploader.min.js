function c(){return function(){}}var j=j||{}; j.W=function(a){this.a={element:null,action:"/server/upload",ua:{},J:[],z:0,Da:c(),f:c(),va:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',pa:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',K:{button:"qq-upload-button", ya:"qq-upload-drop-area",s:"qq-upload-drop-area-active",Ca:"qq-upload-list",Aa:"qq-upload-file",Fa:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",V:"qq-upload-success",oa:"qq-upload-fail"},ta:{Ga:"{file} has invalid extension. Only {extensions} are allowed.",Ea:"{file} is too large, maximum file size is {sizeLimit}.",za:"{file} is empty, please select files again without it."},U:function(d){alert(d)}};j.extend(this.a,a);this.b=this.a.element;if(this.b.nodeType!=1)throw Error("element param of FileUploader should be dom node"); this.b.innerHTML=this.a.va;this.C=0;this.g=this.a.K;this.k=this.ea();this.aa();var b=this;this.ba=new j.A({element:this.d("button"),multiple:j.j.isSupported(),N:function(d){b.ia(d)}});this.ja()}; j.W.prototype={d:function(a,b){if(typeof a=="string"){b=a;a=this.b}var d=j.qa(a,this.a.K[b])[0];if(!d)throw Error("element not found "+b);return d},p:function(a,b){var d=this.a.ta[a];d=d.replace("{file}",this.D(b));d=d.replace("{extensions}",this.a.J.join(", "));d=d.replace("{sizeLimit}",this.q(this.a.z));this.a.U(d)},D:function(a){if(a.length>33)a=a.slice(0,19)+"..."+a.slice(-13);return a},ha:function(a){a=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"";var b=this.a.J;if(!b.length)return true; for(var d=0;d<b.length;d++)if(b[d].toLowerCase()==a)return true;return false},ja:function(){var a=this,b=this.d("drop"),d=new j.o({element:b,P:function(e){j.m(b,a.g.s);e.stopPropagation()},Q:function(e){e.stopPropagation()},R:function(){j.n(b,a.g.s)},O:function(e){b.style.display="none";j.n(b,a.g.s);a.H(e.dataTransfer.files)}});b.style.display="none";j.c(document,"dragenter",function(e){if(d.i(e))b.style.display="block"});j.c(document,"dragleave",function(e){if(d.i(e)){e=document.elementFromPoint(e.clientX, e.clientY);if(!e||e.nodeName=="HTML")b.style.display="none"}})},ea:function(){var a=this,b;b=j.j.isSupported()?"UploadHandlerXhr":"UploadHandlerForm";return new j[b]({action:this.a.action,w:function(d,e,g,f){a.ka(d,g,f)},f:function(d,e,g){a.C--;var f=a.F(d);j.remove(a.d(f,"cancel"));j.remove(a.d(f,"spinner"));if(g.V)j.m(f,a.g.V);else{j.m(f,a.g.oa);g.error&&a.a.U(g.error)}a.a.f(d,e,g)}})},ia:function(a){if(this.k instanceof j.j)this.H(a.files);else this.I(a)&&this.G(a);this.ba.reset()},H:function(a){for(var b= true,d=a.length;d--;)if(!this.I(a[d])){b=false;break}if(b)for(d=a.length;d--;)this.G(a[d])},G:function(a){a=this.k.add(a);var b=this.k.getName(a);this.Y(a,b);this.k.upload(a,this.a.ua)},I:function(a){var b,d;if(a.value)b=a.value.replace(/.*(\/|\\)/,"");else{b=a.fileName!=null?a.fileName:a.name;d=a.fileSize!=null?a.fileSize:a.size}if(this.ha(b))if(d===0){this.p("emptyError",b);return false}else{if(d&&this.a.z&&d>this.a.z){this.p("sizeError",b);return false}}else{this.p("typeError",b);return false}return true}, Y:function(a,b){var d=j.toElement(this.a.pa);d.S=a;var e=this.d(d,"file");j.T(e,this.D(b));this.d(d,"size").style.display="none";this.d("list").appendChild(d);this.C++},ka:function(a,b,d){a=this.d(this.F(a),"size");a.style.display="inline";j.T(a,b!=d?Math.round(b/d*100)+"% from "+this.q(d):this.q(d))},q:function(a){var b=-1;do{a/=1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]},F:function(a){for(var b=this.d("list").firstChild;b;){if(b.S==a)return b;b=b.nextSibling}}, aa:function(){var a=this,b=this.d("list");j.c(b,"click",function(d){d=d||window.event;var e=d.target||d.srcElement;if(j.u(e,a.g.cancel)){j.preventDefault(d);d=e.parentNode;a.k.cancel(d.S);j.remove(d)}})}};j.o=function(a){this.a={element:null,P:c(),Q:c(),R:c(),O:c()};j.extend(this.a,a);this.b=this.a.element;this.fa();this.Z()}; j.o.prototype={fa:function(){if(!j.o.ma){j.c(document,"dragover",function(a){a.dataTransfer.la="none";a.preventDefault()});j.o.ma=true}},Z:function(){var a=this;j.c(a.b,"dragover",function(b){if(a.i(b)){var d=b.dataTransfer.na;b.dataTransfer.la=d=="move"||d=="linkMove"?"move":"copy";b.stopPropagation();b.preventDefault()}});j.c(a.b,"dragenter",function(b){a.i(b)&&a.a.P(b)});j.c(a.b,"dragleave",function(b){if(a.i(b)){a.a.Q(b);var d=document.elementFromPoint(b.clientX,b.clientY);j.contains(this,d)|| a.a.R(b)}});j.c(a.b,"drop",function(b){if(a.i(b)){b.preventDefault();a.a.O(b)}})},i:function(a){a=a.dataTransfer;var b=navigator.userAgent.indexOf("AppleWebKit")>-1;return a&&a.na!="none"&&(a.files||!b&&a.wa.contains&&a.wa.contains("Files"))}};j.A=function(a){this.a={element:null,multiple:false,name:"file",N:c(),M:"qq-upload-button-hover",t:"qq-upload-button-focus"};j.extend(this.a,a);this.b=this.a.element;j.L(this.b,{position:"relative",overflow:"hidden",direction:"ltr"});this.r=this.B()}; j.A.prototype={reset:function(){this.r.parentNode&&j.remove(this.r);j.n(this.b,this.a.t);this.r=this.B()},B:function(){var a=document.createElement("input");this.a.multiple&&a.setAttribute("multiple","multiple");a.setAttribute("type","file");a.setAttribute("name",this.a.name);j.L(a,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0});this.b.appendChild(a);var b=this;j.c(a,"change",function(){b.a.N(a)});j.c(a,"mouseover",function(){j.m(b.b, b.a.M)});j.c(a,"mouseout",function(){j.n(b.b,b.a.M)});j.c(a,"focus",function(){j.m(b.b,b.a.t)});j.c(a,"blur",function(){j.n(b.b,b.a.t)});window.attachEvent&&a.setAttribute("tabIndex","-1");return a}};j.X=function(a){this.a={action:"/upload",f:c()};j.extend(this.a,a);this.h={}}; j.X.prototype={add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+j.sa();this.h[b]=a;a.parentNode&&j.remove(a);return b},upload:function(a,b){var d=this.h[a];if(!d)throw Error("file with passed id was not added, or already uploaded or cancelled");var e=this.getName(a),g=this.da(a),f=this.ca(g,b);f.appendChild(d);var h=this;this.$(g,function(){h.a.f(a,e,h.ga(g));delete h.h[a];setTimeout(function(){j.remove(g)},1)});f.submit();j.remove(f);return a},cancel:function(a){a in this.h&&delete this.h[a];if(a=document.getElementById(a)){a.setAttribute("src","javascript:false;");j.remove(a)}},getName:function(a){return this.h[a].value.replace(/.*(\/|\\)/,"")},$:function(a,b){j.c(a,"load",function(){if(a.parentNode)a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false"||b()})},ga:function(a){a=a.contentDocument?a.contentDocument:a.contentWindow.document;var b;try{b=eval("("+a.body.innerHTML+")")}catch(d){b={}}return b},da:function(a){var b=j.toElement('<iframe src="javascript:false;" name="'+ a+'" />');b.setAttribute("id",a);b.style.display="none";document.body.appendChild(b);return b},ca:function(a,b){var d=j.toElement('<form method="post" enctype="multipart/form-data"></form>'),e="?"+j.v(b);d.setAttribute("action",this.a.action+e);d.setAttribute("target",a.name);d.style.display="none";document.body.appendChild(d);return d}};j.j=function(a){this.a={action:"/upload",w:c(),f:c()};j.extend(this.a,a);this.e=[];this.l=[]}; j.j.isSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&typeof File!="undefined"&&typeof(new XMLHttpRequest).upload!="undefined"}; j.j.prototype={add:function(a){return this.e.push(a)-1},upload:function(a,b){var d=this.e[a],e=this.getName(a),g=this.ra(a);if(!d)throw Error("file with passed id was not added, or already uploaded or cancelled");var f=this.l[a]=new XMLHttpRequest,h=this;f.upload.onprogress=function(i){i.lengthComputable&&h.a.w(a,e,i.loaded,i.total)};f.onreadystatechange=function(){if(h.e[a])if(f.readyState==4){h.a.w(a,e,g,g);if(f.status==200){var i;try{i=eval("("+f.responseText+")")}catch(l){i={}}h.a.f(a,e,i)}else h.a.f(a, e,{});h.e[a]=null;h.l[a]=null}};var k="?qqfile="+encodeURIComponent(e)+"&"+j.v(b);f.open("POST",this.a.action+k,true);f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.setRequestHeader("X-File-Name",encodeURIComponent(e));f.send(d)},cancel:function(a){this.e[a]=null;if(this.l[a]){this.l[a].abort();this.l[a]=null}},getName:function(a){a=this.e[a];return a.fileName!=null?a.fileName:a.name},ra:function(a){a=this.e[a];return a.fileSize!=null?a.fileSize:a.size}};j=j||{}; j.extend=function(a,b){for(var d in b)a[d]=b[d]};j.sa=function(){var a=0;return function(){return a++}}();j.c=function(a,b,d){if(a.addEventListener)a.addEventListener(b,d,false);else a.attachEvent&&a.attachEvent("on"+b,d)};j.detach=function(a,b,d){if(a.removeEventListener)a.removeEventListener(b,d,false);else a.attachEvent&&a.detachEvent("on"+b,d)};j.preventDefault=function(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false}; j.insertBefore=function(a,b){b.parentNode.insertBefore(a,b)};j.remove=function(a){a.parentNode.removeChild(a)};j.contains=function(a,b){if(a==b)return true;return a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8)};j.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}(); j.L=function(a,b){if(b.opacity!=null)if(typeof a.style.opacity!="string"&&typeof a.Ba!="undefined")b.filter="alpha(opacity="+Math.round(100*b.opacity)+")";j.extend(a.style,b)};j.u=function(a,b){return RegExp("(^| )"+b+"( |$)").test(a.className)};j.m=function(a,b){j.u(a,b)||(a.className+=" "+b)};j.n=function(a,b){a.className=a.className.replace(RegExp("(^| )"+b+"( |$)")," ").replace(/^\s+|\s+$/g,"")};j.T=function(a,b){a.innerText=b;a.textContent=b}; j.xa=function(a){var b=[];for(a=a.firstChild;a;){a.nodeType==1&&b.push(a);a=a.nextSibling}return b};j.qa=function(a,b){if(a.querySelectorAll)return a.querySelectorAll("."+b);for(var d=[],e=a.getElementsByTagName("*"),g=e.length,f=0;f<g;f++)j.u(e[f],b)&&d.push(e[f]);return d}; j.v=function(a,b){var d=[];function e(h,k){var i=b?/\[\]$/.test(b)?b:b+"["+k+"]":k;d.push(typeof h==="object"?j.v(h,i):Object.prototype.toString.call(h)==="[object Function]"?encodeURIComponent(i)+"="+encodeURIComponent(h()):encodeURIComponent(i)+"="+encodeURIComponent(h))}if(Object.prototype.toString.call(a)==="[object Array]")for(var g=0,f=a.length;g<f;++g)e(a[g],g);else if(a!==undefined&&a!==null&&typeof a==="object")for(g in a)e(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a)); return d.join("&").replace(/%20/g,"+")};
